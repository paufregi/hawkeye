groups: []
resources:
- name: pull-request-scala
  type: pull-request
  source:
    access_token: ((github-access-token))
    every: true
    paths:
    - archery/arrow/*
    - project/*
    - build.sbt
    private_key: ((github-private-key))
    repo: paufregi/hawkeye
- name: pull-request-python
  type: pull-request
  source:
    access_token: ((github-access-token))
    every: true
    paths:
    - archery/bow/*
    - archery/*
    - ci/*
    private_key: ((github-private-key))
    repo: paufregi/hawkeye
resource_types:
- name: pull-request
  type: docker-image
  source:
    repository: jtarchie/pr
jobs:
- name: verify-scala
  plan:
  - get: pull-request-scala
    trigger: true
    version: every
  - put: pull-request-scala
    params:
      context: archery/scala
      path: pull-request-scala
      status: pending
  - aggregate:
    - task: sbt-test
      file: pull-request-scala/ci/tasks/sbt/test.yml
      params:
        PROJECT: arrow
      input_mapping:
        repo: pull-request-scala
    - task: sbt-it-test
      file: pull-request-scala/ci/tasks/sbt/it-test.yml
      params:
        PROJECT: arrow
      input_mapping:
        repo: pull-request-scala
  on_failure:
    put: pull-request-scala
    params:
      context: archery/scala
      path: pull-request-scala
      status: failure
  on_success:
    put: pull-request-scala
    params:
      context: archery/scala
      path: pull-request-scala
      status: success
- name: verify-python
  plan:
  - get: pull-request-python
    trigger: true
    version: every
  - put: pull-request-python
    params:
      context: archery/python
      path: pull-request-python
      status: pending
  - task: pytest
    file: pull-request-python/ci/tasks/python/test.yml
    params:
      SRC_PATH: archery/bow
    input_mapping:
      repo: pull-request-python
  on_failure:
    put: pull-request-python
    params:
      context: archery/python
      path: pull-request-python
      status: failure
  on_success:
    put: pull-request-python
    params:
      context: archery/python
      path: pull-request-python
      status: success
